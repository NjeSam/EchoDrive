name: CI Pipeline

on:
  push:
    branches: [ main, devel ]
  pull_request:
    branches: [ main, devel ]

jobs:
  build-and-test:
    runs-on: ubuntu-latest

    steps:
    - name: âœ… Checkout repozitorijuma
      uses: actions/checkout@v4

    - name: ğŸ Postavi Python okruÅ¾enje
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'

    - name: ğŸ“¦ Instaliraj zavisnosti
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt || true
        pip install pytest

    - name: âœ… Proveri sintaksu fajlova
      run: |
        python -m py_compile generate_spectrograms.py || true
        python -m py_compile neuronska_projekat.py || true

    - name: ğŸ§ª Pokreni unit testove (tests/)
      run: |
        pytest tests/ || echo "âš ï¸ Testovi nisu proÅ¡li ili ne postoje"

    - name: ğŸ›  Build aplikacije (samo na main)
      if: github.ref == 'refs/heads/main'
      run: |
        echo "ğŸ— Ovde bi iÅ¡la komanda za build, npr: python setup.py build"
        mkdir build
        cp neuronska_projekat.py build/

    - name: ğŸš€ Deploy aplikacije (samo na main)
      if: github.ref == 'refs/heads/main'
      run: |
        echo "ğŸš€ Deploy skripta ovde (npr. SCP, rsync, Docker push...)"
        echo "ğŸ“¦ Poslato na server ili hosting"
